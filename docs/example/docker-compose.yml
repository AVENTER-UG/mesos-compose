version: '3.9'
services:
  app:
    image: alpine:latest
    command: "sleep 1000"
    restart: always
    volumes:
      - "12345test:/tmp"
    environment:
      - MYSQL_HOST=test
    labels:
      biz.aventer.mesos_compose.container_type: "DOCKER"
      traefik.enable: "true"
      traefik.http.routers.test.entrypoints: "web"
      traefik.http.routers.test.service: "mc_test_app_80"
      traefik.http.routers.test.rule: "HostRegexp(`example.com`, `{subdomain:[a-z]+}.example.com`)"
    network_mode: "BRIDGE"
    pull_policy: always
    ports:
      - "8080:80"
    network:
      - default
    cap_add:
      - SYS_ADMIN
    cap_drop:
      - NET_ADMIN
    deploy:
      placement:
        constraints:
          - "node.hostname==localhost"
      replicas: 1
      resources:
        limits:
          cpus: "0.01"
          memory: "50"

networks:
  default:
    external: true
    name: weave

volumes:
  12345test:
    driver: local
